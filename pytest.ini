[pytest]
# Django settings module for pytest
DJANGO_SETTINGS_MODULE = nzila_export.settings

# Python files matching patterns will be collected as test modules
python_files = test_*.py *_test.py

# Python classes matching patterns will be collected as test classes
python_classes = Test* *Tests *TestCase

# Python functions matching patterns will be collected as tests
python_functions = test_*

# Directory patterns to search for tests
testpaths = tests

# Ignore patterns - directories to skip during test collection
norecursedirs = .git .tox dist build *.egg node_modules .venv venv

# Minimum Python version required
minversion = 7.0

# Additional command line options to always use
addopts =
    # Show extra test summary info for all test outcomes
    -ra
    # Verbose output showing each test name
    -v
    # Show local variables in tracebacks
    --showlocals
    # Strict markers - only use registered markers
    --strict-markers
    # Strict config - warn about unknown config options
    --strict-config
    # Enable coverage reporting
    --cov=.
    # Exclude specific directories from coverage
    --cov-config=.coveragerc
    # Show missing lines in coverage report
    --cov-report=term-missing
    # Generate HTML coverage report
    --cov-report=html:htmlcov
    # Generate XML coverage report for CI/CD
    --cov-report=xml:coverage.xml
    # Fail if coverage is below 80%
    --cov-fail-under=80
    # Disable pytest warnings summary
    --disable-warnings
    # Show durations of slowest 10 tests
    --durations=10

# Custom markers for categorizing tests
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    unit: marks tests as unit tests
    e2e: marks tests as end-to-end tests
    smoke: marks tests as smoke tests (quick validation)
    regression: marks tests as regression tests
    api: marks tests requiring API calls
    database: marks tests requiring database access
    authentication: marks tests for authentication flows
    payments: marks tests for payment processing
    deals: marks tests for deal management
    vehicles: marks tests for vehicle operations
    exports: marks tests for export generation
    admin: marks tests for admin functionality
    customer: marks tests for customer portal
    dealer: marks tests for dealer functionality

# Django configuration
django_find_project = true

# Logging configuration
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Timeout for tests (prevent hanging tests)
timeout = 300
timeout_method = thread

# Asyncio configuration
asyncio_mode = auto

# Output configuration
console_output_style = progress

# Warnings configuration
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::FutureWarning

# Cache configuration
cache_dir = .pytest_cache
